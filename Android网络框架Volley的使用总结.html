<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Android网络框架Volley的使用总结</title>
</head>
<body>
<div id="wmd-preview" class="wmd-preview"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="0bkt" id="android网络框架volley的使用总结">Android网络框架Volley的使用总结</h1><hr><pre data-anchor-id="pc2c"><code>其实Volley网络框架实现了二级缓存机制（内存和网络），比如页面的信息刚使用Volley网络框架来请求数据，那么它的数据可以保存在缓存中，页面跳转到其他页面后，再跳转到原来缓存过的页面，那么这时是不需要重复请求网络数据的。但是内存保存时间并不长久，它只能保证短时间内相同的数据资源不需要再次请求网络，从而节省用户流量。 
   如果是要数据长久保存需要用到三级缓存机制。使用Volley也可以实现三级缓存机制，但是需要我们自己对数据经行判断和写入本地。 
</code></pre><p data-anchor-id="tb3n">一．Volley网络框架基础介绍</p><p data-anchor-id="n8r2">Volley是一个网络通信库，它使得Android进行网络请求时更加方便、快速、健壮，同时对网络图片加载也提供了良好的支持。  <br>
Volley中有Android 异步网络请求框架和图片加载框架。  <br>
如果要下载资源的包可以在github中直接下载，网址：<a href="https://github.com/mcxiaoke/android-volley" target="_blank">https://github.com/mcxiaoke/android-volley</a>  <br>
如果是使用AndroidStudio开发，可以直接依赖包：</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="rsi2"><ol class="linenums"><li class="L0"><code><span class="pln">compile </span><span class="pun">‘</span><span class="pln">com</span><span class="pun">.</span><span class="pln">android</span><span class="pun">.</span><span class="pln">volley</span><span class="pun">:</span><span class="pln">volley</span><span class="pun">:</span><span class="lit">1.0</span><span class="pun">.</span><span class="lit">0</span><span class="pun">’</span></code></li></ol></pre><p data-anchor-id="tehm">（一）Volley试用场景：</p><pre data-anchor-id="fk6f"><code>   适合数据量小，通信频繁的网络操作。文本数据应用较多。比如也几个页面的文本数据，只要查看过一次后，以后来回切换，或退出程序再进入页面都是不用网络都能显示文本的。 
   如果加载较多的图片还是使用其他的强大一点的网络框架会好点。手机内存毕竟容量有限。 
   AndroidStudio使用Volley之前添加依赖就可以了： 
</code></pre><p data-anchor-id="50w2">compile ‘com.android.volley:volley:1.0.0’  <br>
GitHub中的源码地址：  <br>
<a href="https://github.com/mcxiaoke/android-volley" target="_blank">https://github.com/mcxiaoke/android-volley</a></p><p data-anchor-id="l89f">（二）Volley四个类的作用：</p><p data-anchor-id="3vdc">1.RequestQueue：请求队列</p><p data-anchor-id="bmjh">通过 newRequestQueue(…) 函数新建并启动一个请求队列RequestQueue。</p><p data-anchor-id="dv86">2.Request：请求的抽象类。</p><p data-anchor-id="thj7">StringRequest、JsonRequest、ImageRequest 都是它的子类，表示某种类型的请求。</p><p data-anchor-id="0ors">3.ImageLoader：有缓存的图片下载的操作类</p><p data-anchor-id="y1pw">4.LruCache数据缓存类</p><p data-anchor-id="kj5y">（三）StringRequest的使用方法:</p><ol data-anchor-id="5euj">
<li><p>调用Volley的static方法 <strong>newRequestQueue(context)</strong>,</p>

<p>得到<strong>RequestQueue对象</strong>, 之后所有的网络请求都添加到这个RequestQueue对象就可以了. </p></li>
</ol><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="erw5"><ol class="linenums"><li class="L0"><code><span class="typ">RequestQueue</span><span class="pln"> mQueue </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Volley</span><span class="pun">.</span><span class="pln">newRequestQueue</span><span class="pun">(</span><span class="pln">context</span><span class="pun">);</span></code></li></ol></pre><ol data-anchor-id="pyz7">
<li>new一个StringRequest对象， 访问url， 得到服务端返回的字符串.</li>
</ol><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="wll2"><ol class="linenums"><li class="L0"><code><span class="typ">StringRequest</span><span class="pln"> stringRequest </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">StringRequest</span><span class="pun">(</span><span class="str">"http://www.baidu.com"</span><span class="pun">,</span></code></li><li class="L1"><code><span class="pln">                        </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">.</span><span class="typ">Listener</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">&gt;()</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L2"><code><span class="pln">                            </span><span class="lit">@Override</span></code></li><li class="L3"><code><span class="pln">                            </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> onResponse</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> response</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L4"><code><span class="pln">                                </span><span class="typ">Log</span><span class="pun">.</span><span class="pln">d</span><span class="pun">(</span><span class="str">"TAG"</span><span class="pun">,</span><span class="pln"> response</span><span class="pun">);</span></code></li><li class="L5"><code><span class="pln">                            </span><span class="pun">}</span></code></li><li class="L6"><code><span class="pln">                        </span><span class="pun">},</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">.</span><span class="typ">ErrorListener</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L7"><code><span class="pln">                            </span><span class="lit">@Override</span></code></li><li class="L8"><code><span class="pln">                            </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> onErrorResponse</span><span class="pun">(</span><span class="typ">VolleyError</span><span class="pln"> error</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L9"><code><span class="pln">                                </span><span class="typ">Log</span><span class="pun">.</span><span class="pln">e</span><span class="pun">(</span><span class="str">"TAG"</span><span class="pun">,</span><span class="pln"> error</span><span class="pun">.</span><span class="pln">getMessage</span><span class="pun">(),</span><span class="pln"> error</span><span class="pun">);</span></code></li><li class="L0"><code><span class="pln">                            </span><span class="pun">}</span></code></li><li class="L1"><code><span class="pln">                        </span><span class="pun">});</span></code></li></ol></pre><p data-anchor-id="wy1t">StringRequest的构造函数需要传入三个参数，第一个参数就是目标服务器的URL地址，第二个参数是服务器响应成功的回调，第三个参数是服务器响应失败的回调。</p><ol data-anchor-id="tkjn">
<li>最后，将这个StringRequest对象添加到RequestQueue里面就可以了.</li>
</ol><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="34lm"><ol class="linenums"><li class="L0"><code><span class="pln">mQueue</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="pln">stringRequest</span><span class="pun">);</span><span class="pln"> </span></code></li></ol></pre><ol data-anchor-id="rtt5">
<li>默认是GET请求， 如果要使用POST请求的话， 就需要使用带4个参数的StringRequest()构造方法. 请求参数通过重写父类Request中的getParams()方法来设置.</li>
</ol><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="217f"><ol class="linenums"><li class="L0"><code><span class="typ">StringRequest</span><span class="pln"> stringRequest </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">StringRequest</span><span class="pun">(</span><span class="typ">Method</span><span class="pun">.</span><span class="pln">POST</span><span class="pun">,</span><span class="pln"> url</span><span class="pun">,</span><span class="pln">  listener</span><span class="pun">,</span><span class="pln"> errorListener</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code><span class="pln">    </span><span class="lit">@Override</span></code></li><li class="L2"><code><span class="pln">    </span><span class="kwd">protected</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="typ">String</span><span class="pun">&gt;</span><span class="pln"> getParams</span><span class="pun">()</span><span class="pln"> </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">AuthFailureError</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L3"><code><span class="pln">        </span><span class="typ">Map</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="typ">String</span><span class="pun">&gt;</span><span class="pln"> map </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">HashMap</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="typ">String</span><span class="pun">&gt;();</span></code></li><li class="L4"><code><span class="pln">        map</span><span class="pun">.</span><span class="pln">put</span><span class="pun">(</span><span class="str">"params1"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"value1"</span><span class="pun">);</span></code></li><li class="L5"><code><span class="pln">        map</span><span class="pun">.</span><span class="pln">put</span><span class="pun">(</span><span class="str">"params2"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"value2"</span><span class="pun">);</span></code></li><li class="L6"><code><span class="pln">        </span><span class="kwd">return</span><span class="pln"> map</span><span class="pun">;</span></code></li><li class="L7"><code><span class="pln">    </span><span class="pun">}</span></code></li><li class="L8"><code><span class="pun">};</span></code></li></ol></pre><p data-anchor-id="vln5">（四）JsonRequest的用法</p><p data-anchor-id="wufv">JsonRequest有两个直接的子类，JsonObjectRequest和JsonArrayRequest，一个是用于请求一段JSON数据的，一个是用于请求一段JSON数组的。  <br>
使用方法和StringRequest类似.</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="2v36"><ol class="linenums"><li class="L0"><code><span class="typ">JsonObjectRequest</span><span class="pln"> jsonObjectRequest </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">JsonObjectRequest</span><span class="pun">(</span><span class="str">"http://m.weather.com.cn/data/101010100.html"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">,</span></code></li><li class="L1"><code><span class="pln">        </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">.</span><span class="typ">Listener</span><span class="pun">&lt;</span><span class="typ">JSONObject</span><span class="pun">&gt;()</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L2"><code><span class="pln">            </span><span class="lit">@Override</span></code></li><li class="L3"><code><span class="pln">            </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> onResponse</span><span class="pun">(</span><span class="typ">JSONObject</span><span class="pln"> response</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L4"><code><span class="pln">                </span><span class="typ">Log</span><span class="pun">.</span><span class="pln">d</span><span class="pun">(</span><span class="str">"TAG"</span><span class="pun">,</span><span class="pln"> response</span><span class="pun">.</span><span class="pln">toString</span><span class="pun">());</span></code></li><li class="L5"><code><span class="pln">            </span><span class="pun">}</span></code></li><li class="L6"><code><span class="pln">        </span><span class="pun">},</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">.</span><span class="typ">ErrorListener</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L7"><code><span class="pln">            </span><span class="lit">@Override</span></code></li><li class="L8"><code><span class="pln">            </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> onErrorResponse</span><span class="pun">(</span><span class="typ">VolleyError</span><span class="pln"> error</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L9"><code><span class="pln">                </span><span class="typ">Log</span><span class="pun">.</span><span class="pln">e</span><span class="pun">(</span><span class="str">"TAG"</span><span class="pun">,</span><span class="pln"> error</span><span class="pun">.</span><span class="pln">getMessage</span><span class="pun">(),</span><span class="pln"> error</span><span class="pun">);</span></code></li><li class="L0"><code><span class="pln">            </span><span class="pun">}</span></code></li><li class="L1"><code><span class="pln">        </span><span class="pun">});</span></code></li><li class="L2"><code><span class="pln">mQueue</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="pln">jsonObjectRequest</span><span class="pun">);</span></code></li></ol></pre><pre data-anchor-id="xxsz"><code>   Volley是将AsyncHttpClient和Universal-Image-Loader的优点集成于一身的一个框架。我们都知道，Universal-Image-Loader具备非常强大的加载网络图片的功能，而使用Volley，我们也可以实现基本类似的效果，并且在性能上也豪不逊色于Universal-Image-Loader，下面我们就来具体学习一下吧。
</code></pre><p data-anchor-id="gzuk">（五）ImageRequest的用法</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="imw1"><ol class="linenums"><li class="L0"><code><span class="typ">ImageRequest</span><span class="pln"> imageRequest </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ImageRequest</span><span class="pun">(</span></code></li><li class="L1"><code><span class="pln">        </span><span class="str">"http://developer.android.com/images/home/aw_dac.png"</span><span class="pun">,</span></code></li><li class="L2"><code><span class="pln">        </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">.</span><span class="typ">Listener</span><span class="pun">&lt;</span><span class="typ">Bitmap</span><span class="pun">&gt;()</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L3"><code><span class="pln">            </span><span class="lit">@Override</span></code></li><li class="L4"><code><span class="pln">            </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> onResponse</span><span class="pun">(</span><span class="typ">Bitmap</span><span class="pln"> response</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L5"><code><span class="pln">                imageView</span><span class="pun">.</span><span class="pln">setImageBitmap</span><span class="pun">(</span><span class="pln">response</span><span class="pun">);</span></code></li><li class="L6"><code><span class="pln">            </span><span class="pun">}</span></code></li><li class="L7"><code><span class="pln">        </span><span class="pun">},</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Config</span><span class="pun">.</span><span class="pln">RGB_565</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">.</span><span class="typ">ErrorListener</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L8"><code><span class="pln">            </span><span class="lit">@Override</span></code></li><li class="L9"><code><span class="pln">            </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> onErrorResponse</span><span class="pun">(</span><span class="typ">VolleyError</span><span class="pln"> error</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L0"><code><span class="pln">                imageView</span><span class="pun">.</span><span class="pln">setImageResource</span><span class="pun">(</span><span class="pln">R</span><span class="pun">.</span><span class="pln">drawable</span><span class="pun">.</span><span class="pln">default_image</span><span class="pun">);</span></code></li><li class="L1"><code><span class="pln">            </span><span class="pun">}</span></code></li><li class="L2"><code><span class="pln">        </span><span class="pun">});</span></code></li></ol></pre><pre data-anchor-id="0xr0"><code>   第三第四个参数分别用于指定允许图片最大的宽度和高度，如果指定的网络图片的宽度或高度大于这里的最大值，则会对图片进行压缩，指定成0的话就表示不管图片有多大，都不会进行压缩。第五个参数用于指定图片的颜色属性，其中ARGB_8888可以展示最好的颜色属性，每个图片像素占据4个字节的大小，而RGB_565则表示每个图片像素占据2个字节大小。 
   第六个参数是图片请求失败的回调，这里我们当请求失败时在ImageView中显示一张默认图片。 
   最后把这个ImageRequest对象添加到RequestQueue对象中去就可以了. 
</code></pre><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="ctlq"><ol class="linenums"><li class="L0"><code><span class="pln">mQueue</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="pln">imageRequest</span><span class="pun">);</span></code></li></ol></pre><p data-anchor-id="2g5f">（六）ImageLoader的用法</p><pre data-anchor-id="k2id"><code>   为了让开发者更方便的加载网络图片，Volley还提供了ImageLoader, 并且它的内部也是使用ImageRequest来实现的，不过ImageLoader明显要比ImageRequest更加高效，因为它不仅可以帮我们对图片进行缓存，还可以过滤掉重复的链接，避免重复发送请求。 
</code></pre><p data-anchor-id="gkn0">分为以下几步:</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="d9zv"><ol class="linenums"><li class="L0"><code><span class="pun">创建一个</span><span class="typ">ImageLoader</span><span class="pun">对象</span></code></li><li class="L1"><code><span class="typ">ImageLoader</span><span class="pln"> imageLoader </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ImageLoader</span><span class="pun">(</span><span class="pln">mQueue</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ImageCache</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L2"><code><span class="pln">    </span><span class="lit">@Override</span></code></li><li class="L3"><code><span class="pln">    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> putBitmap</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> url</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Bitmap</span><span class="pln"> bitmap</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L4"><code><span class="pln">    </span><span class="pun">}</span></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="pln">    </span><span class="lit">@Override</span></code></li><li class="L7"><code><span class="pln">    </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">Bitmap</span><span class="pln"> getBitmap</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> url</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L8"><code><span class="pln">        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span></code></li><li class="L9"><code><span class="pln">    </span><span class="pun">}</span></code></li><li class="L0"><code><span class="pun">});</span><span class="com">//这里并没有让ImageLoader具备缓存功能.</span></code></li><li class="L1"><code><span class="pun">获取一个</span><span class="typ">ImageListener</span><span class="pun">对象</span></code></li><li class="L2"><code><span class="typ">ImageListener</span><span class="pln"> listener </span><span class="pun">=</span><span class="pln"> </span><span class="typ">ImageLoader</span><span class="pun">.</span><span class="pln">getImageListener</span><span class="pun">(</span><span class="pln">imageView</span><span class="pun">,</span></code></li><li class="L3"><code><span class="pln">        R</span><span class="pun">.</span><span class="pln">drawable</span><span class="pun">.</span><span class="pln">default_image</span><span class="pun">,</span><span class="pln"> R</span><span class="pun">.</span><span class="pln">drawable</span><span class="pun">.</span><span class="pln">failed_image</span><span class="pun">);</span><span class="com">//第一个参数指定用于显示图片的ImageView控件，//第二个参数指定加载图片的过程中显示的图片，第三个参数指定加载图片失败的情况下显示的图片。</span></code></li><li class="L4"><code><span class="pun">调用</span><span class="typ">ImageLoader</span><span class="pun">的</span><span class="kwd">get</span><span class="pun">()方法加载网络上的图片</span></code></li><li class="L5"><code><span class="pln">imageLoader</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">"http://img.my.csdn.net/uploads/201404/13/1397393290_5765.jpeg"</span><span class="pun">,</span><span class="pln"> listener</span><span class="pun">);</span></code></li><li class="L6"><code><span class="pun">要使用到</span><span class="typ">ImageLoader</span><span class="pun">的缓存功能，</span><span class="pln"> </span><span class="pun">就需要提供一个</span><span class="typ">ImageCache</span><span class="pun">接口的实现类.</span></code></li><li class="L7"><code><span class="pun">这里，</span><span class="pln"> </span><span class="pun">我们在实现的内部通过</span><span class="typ">Android</span><span class="pln"> framework</span><span class="pun">提供的</span><span class="typ">LruCache</span><span class="pun">实现缓存.</span></code></li><li class="L8"><code><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">BitmapCache</span><span class="pln"> </span><span class="kwd">implements</span><span class="pln"> </span><span class="typ">ImageCache</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="pln">    </span><span class="kwd">private</span><span class="pln"> </span><span class="typ">LruCache</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Bitmap</span><span class="pun">&gt;</span><span class="pln"> mCache</span><span class="pun">;</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pln">    </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">BitmapCache</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L3"><code><span class="pln">        </span><span class="kwd">int</span><span class="pln"> maxSize </span><span class="pun">=</span><span class="pln"> </span><span class="lit">10</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">1024</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">1024</span><span class="pun">;</span><span class="pln"> </span><span class="com">//提供一个10Mb的缓存.</span></code></li><li class="L4"><code><span class="pln">        mCache </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">LruCache</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Bitmap</span><span class="pun">&gt;(</span><span class="pln">maxSize</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L5"><code><span class="pln">            </span><span class="lit">@Override</span></code></li><li class="L6"><code><span class="pln">            </span><span class="kwd">protected</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> sizeOf</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> key</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Bitmap</span><span class="pln"> bitmap</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L7"><code><span class="pln">                </span><span class="kwd">return</span><span class="pln"> bitmap</span><span class="pun">.</span><span class="pln">getRowBytes</span><span class="pun">()</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> bitmap</span><span class="pun">.</span><span class="pln">getHeight</span><span class="pun">();</span></code></li><li class="L8"><code><span class="pln">            </span><span class="pun">}</span></code></li><li class="L9"><code><span class="pln">        </span><span class="pun">};</span></code></li><li class="L0"><code><span class="pln">    </span><span class="pun">}</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pln">    </span><span class="lit">@Override</span></code></li><li class="L3"><code><span class="pln">    </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">Bitmap</span><span class="pln"> getBitmap</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> url</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L4"><code><span class="pln">        </span><span class="kwd">return</span><span class="pln"> mCache</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="pln">url</span><span class="pun">);</span></code></li><li class="L5"><code><span class="pln">    </span><span class="pun">}</span></code></li><li class="L6"><code></code></li><li class="L7"><code><span class="pln">    </span><span class="lit">@Override</span></code></li><li class="L8"><code><span class="pln">    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> putBitmap</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> url</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Bitmap</span><span class="pln"> bitmap</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L9"><code><span class="pln">        mCache</span><span class="pun">.</span><span class="pln">put</span><span class="pun">(</span><span class="pln">url</span><span class="pun">,</span><span class="pln"> bitmap</span><span class="pun">);</span></code></li><li class="L0"><code><span class="pln">    </span><span class="pun">}</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pun">}</span></code></li><li class="L3"><code><span class="typ">ImageLoader</span><span class="pln"> imageLoader </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ImageLoader</span><span class="pun">(</span><span class="pln">mQueue</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">BitmapCache</span><span class="pun">());</span></code></li></ol></pre><p data-anchor-id="0f87">二.Volley的一个简单示例</p><p data-anchor-id="lwvs">本程序演示几种简单的网络请求，  <br>
1.get请求文本资源，  <br>
2.post请求文本资源  <br>
3.请求网络图片  <br>
4.使用一级缓存的方式请求图片  <br>
程序运行效果，如图所示：</p><p data-anchor-id="jwnj">点击对于的按钮会触发相应的事件。。。  <br>
上面前两个按钮请求网络的方法都是没有带缓存的，第三、四个按钮的请求网络数据后是带缓存的。第三个按钮使用的是系统的BitmapFactory.decodeByteArray  <br>
缓存，第四个按钮使用的是手动设置的缓存。</p><p data-anchor-id="biat">（一）添加权限</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="ahn8"><ol class="linenums"><li class="L0"><code><span class="tag">&lt;uses-permission</span><span class="pln"> </span><span class="atn">android:name</span><span class="pun">=</span><span class="atv">"android.permission.INTERNET"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></li></ol></pre><p data-anchor-id="ckdw">（二）设计布局页面</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="2hy2"><ol class="linenums"><li class="L0"><code><span class="pun">&lt;?</span><span class="pln">xml version</span><span class="pun">=</span><span class="str">"1.0"</span><span class="pln"> encoding</span><span class="pun">=</span><span class="str">"utf-8"</span><span class="pun">?&gt;</span></code></li><li class="L1"><code><span class="tag">&lt;LinearLayout</span><span class="pln"> </span><span class="atn">xmlns:android</span><span class="pun">=</span><span class="atv">"http://schemas.android.com/apk/res/android"</span></code></li><li class="L2"><code><span class="pln">    </span><span class="atn">android:id</span><span class="pun">=</span><span class="atv">"@+id/activity_main"</span></code></li><li class="L3"><code><span class="pln">    </span><span class="atn">android:layout_width</span><span class="pun">=</span><span class="atv">"match_parent"</span></code></li><li class="L4"><code><span class="pln">    </span><span class="atn">android:layout_height</span><span class="pun">=</span><span class="atv">"match_parent"</span></code></li><li class="L5"><code><span class="pln">    </span><span class="atn">android:orientation</span><span class="pun">=</span><span class="atv">"vertical"</span><span class="tag">&gt;</span></code></li><li class="L6"><code></code></li><li class="L7"><code><span class="pln">    </span><span class="tag">&lt;Button</span></code></li><li class="L8"><code><span class="pln">        </span><span class="atn">android:layout_width</span><span class="pun">=</span><span class="atv">"match_parent"</span></code></li><li class="L9"><code><span class="pln">        </span><span class="atn">android:layout_height</span><span class="pun">=</span><span class="atv">"wrap_content"</span></code></li><li class="L0"><code><span class="pln">        </span><span class="atn">android:onClick</span><span class="pun">=</span><span class="atv">"net1"</span></code></li><li class="L1"><code><span class="pln">        </span><span class="atn">android:text</span><span class="pun">=</span><span class="atv">"请求网络String"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="pln">    </span><span class="tag">&lt;Button</span></code></li><li class="L4"><code><span class="pln">        </span><span class="atn">android:layout_width</span><span class="pun">=</span><span class="atv">"match_parent"</span></code></li><li class="L5"><code><span class="pln">        </span><span class="atn">android:layout_height</span><span class="pun">=</span><span class="atv">"wrap_content"</span></code></li><li class="L6"><code><span class="pln">        </span><span class="atn">android:onClick</span><span class="pun">=</span><span class="atv">"net2"</span></code></li><li class="L7"><code><span class="pln">        </span><span class="atn">android:text</span><span class="pun">=</span><span class="atv">"请求json,带参post"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></li><li class="L8"><code></code></li><li class="L9"><code><span class="pln">    </span><span class="tag">&lt;Button</span></code></li><li class="L0"><code><span class="pln">        </span><span class="atn">android:layout_width</span><span class="pun">=</span><span class="atv">"match_parent"</span></code></li><li class="L1"><code><span class="pln">        </span><span class="atn">android:layout_height</span><span class="pun">=</span><span class="atv">"wrap_content"</span></code></li><li class="L2"><code><span class="pln">        </span><span class="atn">android:onClick</span><span class="pun">=</span><span class="atv">"net3"</span></code></li><li class="L3"><code><span class="pln">        </span><span class="atn">android:text</span><span class="pun">=</span><span class="atv">"图片下载"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></li><li class="L4"><code></code></li><li class="L5"><code><span class="pln">    </span><span class="tag">&lt;Button</span></code></li><li class="L6"><code><span class="pln">        </span><span class="atn">android:layout_width</span><span class="pun">=</span><span class="atv">"match_parent"</span></code></li><li class="L7"><code><span class="pln">        </span><span class="atn">android:layout_height</span><span class="pun">=</span><span class="atv">"wrap_content"</span></code></li><li class="L8"><code><span class="pln">        </span><span class="atn">android:onClick</span><span class="pun">=</span><span class="atv">"net4"</span></code></li><li class="L9"><code><span class="pln">        </span><span class="atn">android:text</span><span class="pun">=</span><span class="atv">"缓存图片下载"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></li><li class="L0"><code></code></li><li class="L1"><code><span class="pln">    </span><span class="tag">&lt;ImageView</span></code></li><li class="L2"><code><span class="pln">        </span><span class="atn">android:id</span><span class="pun">=</span><span class="atv">"@+id/main_iv"</span></code></li><li class="L3"><code><span class="pln">        </span><span class="atn">android:layout_width</span><span class="pun">=</span><span class="atv">"match_parent"</span></code></li><li class="L4"><code><span class="pln">        </span><span class="atn">android:layout_height</span><span class="pun">=</span><span class="atv">"300dp"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></li><li class="L5"><code><span class="tag">&lt;/LinearLayout&gt;</span></code></li></ol></pre><p data-anchor-id="8mrq">上面是比较简单的几个按钮和一个图像显示的布局页面。</p><p data-anchor-id="ttun">（三）java代码的设计</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="97wo"><ol class="linenums"><li class="L0"><code><span class="kwd">package</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">lwz</span><span class="pun">.</span><span class="pln">volley</span><span class="pun">;</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="kwd">import</span><span class="pln"> android</span><span class="pun">.</span><span class="pln">graphics</span><span class="pun">.</span><span class="typ">Bitmap</span><span class="pun">;</span></code></li><li class="L3"><code><span class="kwd">import</span><span class="pln"> android</span><span class="pun">.</span><span class="pln">os</span><span class="pun">.</span><span class="typ">Bundle</span><span class="pun">;</span></code></li><li class="L4"><code><span class="kwd">import</span><span class="pln"> android</span><span class="pun">.</span><span class="pln">support</span><span class="pun">.</span><span class="pln">v4</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.</span><span class="typ">LruCache</span><span class="pun">;</span></code></li><li class="L5"><code><span class="kwd">import</span><span class="pln"> android</span><span class="pun">.</span><span class="pln">support</span><span class="pun">.</span><span class="pln">v7</span><span class="pun">.</span><span class="pln">app</span><span class="pun">.</span><span class="typ">AppCompatActivity</span><span class="pun">;</span></code></li><li class="L6"><code><span class="kwd">import</span><span class="pln"> android</span><span class="pun">.</span><span class="pln">view</span><span class="pun">.</span><span class="typ">View</span><span class="pun">;</span></code></li><li class="L7"><code><span class="kwd">import</span><span class="pln"> android</span><span class="pun">.</span><span class="pln">widget</span><span class="pun">.</span><span class="typ">ImageView</span><span class="pun">;</span></code></li><li class="L8"><code></code></li><li class="L9"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">android</span><span class="pun">.</span><span class="pln">volley</span><span class="pun">.</span><span class="typ">AuthFailureError</span><span class="pun">;</span></code></li><li class="L0"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">android</span><span class="pun">.</span><span class="pln">volley</span><span class="pun">.</span><span class="typ">Request</span><span class="pun">;</span></code></li><li class="L1"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">android</span><span class="pun">.</span><span class="pln">volley</span><span class="pun">.</span><span class="typ">RequestQueue</span><span class="pun">;</span></code></li><li class="L2"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">android</span><span class="pun">.</span><span class="pln">volley</span><span class="pun">.</span><span class="typ">Response</span><span class="pun">;</span></code></li><li class="L3"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">android</span><span class="pun">.</span><span class="pln">volley</span><span class="pun">.</span><span class="typ">VolleyError</span><span class="pun">;</span></code></li><li class="L4"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">android</span><span class="pun">.</span><span class="pln">volley</span><span class="pun">.</span><span class="pln">toolbox</span><span class="pun">.</span><span class="typ">ImageLoader</span><span class="pun">;</span></code></li><li class="L5"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">android</span><span class="pun">.</span><span class="pln">volley</span><span class="pun">.</span><span class="pln">toolbox</span><span class="pun">.</span><span class="typ">ImageRequest</span><span class="pun">;</span></code></li><li class="L6"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">android</span><span class="pun">.</span><span class="pln">volley</span><span class="pun">.</span><span class="pln">toolbox</span><span class="pun">.</span><span class="typ">StringRequest</span><span class="pun">;</span></code></li><li class="L7"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">android</span><span class="pun">.</span><span class="pln">volley</span><span class="pun">.</span><span class="pln">toolbox</span><span class="pun">.</span><span class="typ">Volley</span><span class="pun">;</span></code></li><li class="L8"><code></code></li><li class="L9"><code><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.</span><span class="typ">HashMap</span><span class="pun">;</span></code></li><li class="L0"><code><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.</span><span class="typ">Map</span><span class="pun">;</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="com">/**</span></code></li><li class="L3"><code><span class="com"> * 网络框架工具类Volley 的使用</span></code></li><li class="L4"><code><span class="com"> */</span></code></li><li class="L5"><code><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MainActivity</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">AppCompatActivity</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L6"><code></code></li><li class="L7"><code><span class="pln">    </span><span class="typ">ImageView</span><span class="pln"> imageView</span><span class="pun">;</span></code></li><li class="L8"><code></code></li><li class="L9"><code><span class="pln">    </span><span class="lit">@Override</span></code></li><li class="L0"><code><span class="pln">    </span><span class="kwd">protected</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> onCreate</span><span class="pun">(</span><span class="typ">Bundle</span><span class="pln"> savedInstanceState</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code><span class="pln">        </span><span class="kwd">super</span><span class="pun">.</span><span class="pln">onCreate</span><span class="pun">(</span><span class="pln">savedInstanceState</span><span class="pun">);</span></code></li><li class="L2"><code><span class="pln">        setContentView</span><span class="pun">(</span><span class="pln">R</span><span class="pun">.</span><span class="pln">layout</span><span class="pun">.</span><span class="pln">activity_main</span><span class="pun">);</span></code></li><li class="L3"><code><span class="pln">        imageView </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">ImageView</span><span class="pun">)</span><span class="pln"> findViewById</span><span class="pun">(</span><span class="pln">R</span><span class="pun">.</span><span class="pln">id</span><span class="pun">.</span><span class="pln">main_iv</span><span class="pun">);</span></code></li><li class="L4"><code><span class="pln">        </span><span class="typ">ShowUtils</span><span class="pun">.</span><span class="pln">DEBUG </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span></code></li><li class="L5"><code><span class="pln">    </span><span class="pun">}</span></code></li><li class="L6"><code></code></li><li class="L7"><code><span class="pln">    </span><span class="com">/**</span></code></li><li class="L8"><code><span class="com">     * 请求网络的字符串，比如json数据，网页的源码等等</span></code></li><li class="L9"><code><span class="com">     * 这里请求的是网页的源码</span></code></li><li class="L0"><code><span class="com">     */</span></code></li><li class="L1"><code><span class="pln">    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> net1</span><span class="pun">(</span><span class="typ">View</span><span class="pln"> view</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L2"><code><span class="pln">        </span><span class="com">//使用Volley的静态方法来获得队列对象</span></code></li><li class="L3"><code><span class="pln">        </span><span class="typ">RequestQueue</span><span class="pln"> queue </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Volley</span><span class="pun">.</span><span class="pln">newRequestQueue</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">);</span></code></li><li class="L4"><code><span class="pln">        </span><span class="com">//创建请求对象,三个参数</span></code></li><li class="L5"><code><span class="pln">        </span><span class="com">//第一个参数：URL的字符串</span></code></li><li class="L6"><code><span class="pln">        </span><span class="com">//第二个参数：连接成功的回调接口</span></code></li><li class="L7"><code><span class="pln">        </span><span class="com">//第三个参数：连接失败的回调接口</span></code></li><li class="L8"><code><span class="pln">        </span><span class="typ">Request</span><span class="pln"> request </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">StringRequest</span><span class="pun">(</span><span class="str">"https://www.github.com"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">.</span><span class="typ">Listener</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">&gt;()</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L9"><code><span class="pln">            </span><span class="lit">@Override</span></code></li><li class="L0"><code><span class="pln">            </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> onResponse</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> response</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code><span class="pln">                </span><span class="com">//连接成功后</span></code></li><li class="L2"><code><span class="pln">                </span><span class="typ">ShowUtils</span><span class="pun">.</span><span class="pln">e</span><span class="pun">(</span><span class="str">"response"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> response</span><span class="pun">);</span><span class="com">//打印输出</span></code></li><li class="L3"><code><span class="pln">            </span><span class="pun">}</span></code></li><li class="L4"><code><span class="pln">        </span><span class="pun">},</span><span class="pln"> error</span><span class="pun">);</span></code></li><li class="L5"><code><span class="pln">        </span><span class="com">//将请求添加到队列中，并开始执行下载任务</span></code></li><li class="L6"><code><span class="pln">        queue</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="pln">request</span><span class="pun">);</span></code></li><li class="L7"><code><span class="pln">    </span><span class="pun">}</span></code></li><li class="L8"><code></code></li><li class="L9"><code><span class="pln">    </span><span class="com">/**</span></code></li><li class="L0"><code><span class="com">     * 请求网络的字符串，使用Post的方式，默认是get的方式</span></code></li><li class="L1"><code><span class="com">     * 这里在 StringRequest方法的基础上添加一个请求方式的参数</span></code></li><li class="L2"><code><span class="com">     * 这里请求的是API的json数据</span></code></li><li class="L3"><code><span class="com">     */</span></code></li><li class="L4"><code><span class="pln">    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> net2</span><span class="pun">(</span><span class="typ">View</span><span class="pln"> view</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L5"><code><span class="pln">        </span><span class="com">//使用Volley的静态方法来获得队列对象</span></code></li><li class="L6"><code><span class="pln">        </span><span class="typ">RequestQueue</span><span class="pln"> queue </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Volley</span><span class="pun">.</span><span class="pln">newRequestQueue</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">);</span></code></li><li class="L7"><code><span class="pln">        </span><span class="com">//创建请求对象</span></code></li><li class="L8"><code><span class="pln">        </span><span class="com">//第一个参数：请求的方式get或post</span></code></li><li class="L9"><code><span class="pln">        </span><span class="com">//第二个参数：URL的字符串</span></code></li><li class="L0"><code><span class="pln">        </span><span class="com">//第三个参数：连接成功的回调接口</span></code></li><li class="L1"><code><span class="pln">        </span><span class="com">//第四个参数：连接失败的回调接口</span></code></li><li class="L2"><code><span class="pln">        </span><span class="com">//这里在创建连接对象时，在连接的URL上添加参数，</span></code></li><li class="L3"><code><span class="pln">        </span><span class="typ">Request</span><span class="pln"> request </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">StringRequest</span><span class="pun">(</span><span class="typ">Request</span><span class="pun">.</span><span class="typ">Method</span><span class="pun">.</span><span class="pln">POST</span><span class="pun">,</span><span class="pln"> </span><span class="str">"http://route.showapi.com/255-1"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">.</span><span class="typ">Listener</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">&gt;()</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L4"><code><span class="pln">            </span><span class="lit">@Override</span></code></li><li class="L5"><code><span class="pln">            </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> onResponse</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> response</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L6"><code><span class="pln">                </span><span class="com">//连接成功后</span></code></li><li class="L7"><code><span class="pln">                </span><span class="typ">ShowUtils</span><span class="pun">.</span><span class="pln">e</span><span class="pun">(</span><span class="str">"response"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> response</span><span class="pun">);</span><span class="com">//打印输出</span></code></li><li class="L8"><code><span class="pln">            </span><span class="pun">}</span></code></li><li class="L9"><code><span class="pln">        </span><span class="pun">},</span><span class="pln"> error</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L0"><code><span class="pln">            </span><span class="com">//向请求的对象中添加系统级的参数</span></code></li><li class="L1"><code><span class="pln">            </span><span class="lit">@Override</span></code></li><li class="L2"><code><span class="pln">            </span><span class="kwd">protected</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="typ">String</span><span class="pun">&gt;</span><span class="pln"> getParams</span><span class="pun">()</span><span class="pln"> </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">AuthFailureError</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L3"><code><span class="pln">                </span><span class="com">//创建一个HashMap对象来存放程序API的注册id和密钥</span></code></li><li class="L4"><code><span class="pln">                </span><span class="typ">Map</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="typ">String</span><span class="pun">&gt;</span><span class="pln"> map </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">HashMap</span><span class="pun">&lt;&gt;();</span></code></li><li class="L5"><code><span class="pln">                map</span><span class="pun">.</span><span class="pln">put</span><span class="pun">(</span><span class="str">"showapi_appid"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"27350"</span><span class="pun">);</span></code></li><li class="L6"><code><span class="pln">                map</span><span class="pun">.</span><span class="pln">put</span><span class="pun">(</span><span class="str">"showapi_sign"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"d734772ec0fc4b2aac97d6a7f036f767"</span><span class="pun">);</span></code></li><li class="L7"><code><span class="pln">                </span><span class="kwd">return</span><span class="pln"> map</span><span class="pun">;</span></code></li><li class="L8"><code><span class="pln">            </span><span class="pun">}</span></code></li><li class="L9"><code><span class="pln">        </span><span class="pun">};</span></code></li><li class="L0"><code><span class="pln">        </span><span class="com">//将请求添加到队列中，并开始执行下载任务</span></code></li><li class="L1"><code><span class="pln">        queue</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="pln">request</span><span class="pun">);</span></code></li><li class="L2"><code><span class="pln">    </span><span class="pun">}</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="pln">    </span><span class="com">/**</span></code></li><li class="L5"><code><span class="com">     * 请求网络的图片资源，并显示在页面上，这里是做了二级缓存机制</span></code></li><li class="L6"><code><span class="com">     */</span></code></li><li class="L7"><code><span class="pln">    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> net3</span><span class="pun">(</span><span class="typ">View</span><span class="pln"> view</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L8"><code><span class="pln">        </span><span class="com">//使用Volley的静态方法来获得队列对象</span></code></li><li class="L9"><code><span class="pln">        </span><span class="typ">RequestQueue</span><span class="pln"> queue </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Volley</span><span class="pun">.</span><span class="pln">newRequestQueue</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">);</span></code></li><li class="L0"><code><span class="pln">        </span><span class="com">//创建请求图片对象，七个参数</span></code></li><li class="L1"><code><span class="pln">        </span><span class="com">//第一个参数，URL的地址字符串</span></code></li><li class="L2"><code><span class="pln">        </span><span class="com">//第二个参数，网络数据请求成功后的回调方法</span></code></li><li class="L3"><code><span class="pln">        </span><span class="com">//第三个参数，图片的宽</span></code></li><li class="L4"><code><span class="pln">        </span><span class="com">//第四个参数，图片的高</span></code></li><li class="L5"><code><span class="pln">        </span><span class="com">//第五个参数，图片的缩放方式</span></code></li><li class="L6"><code><span class="pln">        </span><span class="com">//第六个参数，图片的压缩品质格式</span></code></li><li class="L7"><code><span class="pln">        </span><span class="com">//第七个参数，网络请求失败的回调方法</span></code></li><li class="L8"><code><span class="pln">        </span><span class="typ">Request</span><span class="pln"> request </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ImageRequest</span><span class="pun">(</span><span class="str">"https://www.showapi.com/images/apiLogo/20150606/5423acc973f41c03173a186a_22b6c6381e3444449b2cfb3724e63c6c.jpg"</span><span class="pun">,</span></code></li><li class="L9"><code><span class="pln">                </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">.</span><span class="typ">Listener</span><span class="pun">&lt;</span><span class="typ">Bitmap</span><span class="pun">&gt;()</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L0"><code><span class="pln">                    </span><span class="lit">@Override</span></code></li><li class="L1"><code><span class="pln">                    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> onResponse</span><span class="pun">(</span><span class="typ">Bitmap</span><span class="pln"> response</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L2"><code><span class="pln">                        </span><span class="typ">ShowUtils</span><span class="pun">.</span><span class="pln">e</span><span class="pun">(</span><span class="str">"response"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">111</span><span class="pun">);</span><span class="com">//打印输出</span></code></li><li class="L3"><code><span class="pln">                        </span><span class="com">//把下载到的Bitmap对象放到指定的图片对象中显示</span></code></li><li class="L4"><code><span class="pln">                        imageView</span><span class="pun">.</span><span class="pln">setImageBitmap</span><span class="pun">(</span><span class="pln">response</span><span class="pun">);</span></code></li><li class="L5"><code><span class="pln">                    </span><span class="pun">}</span></code></li><li class="L6"><code><span class="pln">                </span><span class="pun">},</span><span class="pln"> </span><span class="lit">200</span><span class="pun">,</span><span class="pln"> </span><span class="lit">200</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ImageView</span><span class="pun">.</span><span class="typ">ScaleType</span><span class="pun">.</span><span class="pln">FIT_XY</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Bitmap</span><span class="pun">.</span><span class="typ">Config</span><span class="pun">.</span><span class="pln">RGB_565</span><span class="pun">,</span><span class="pln"> error</span><span class="pun">);</span></code></li><li class="L7"><code><span class="pln">        </span><span class="com">//将请求添加到队列中，并开始执行下载任务</span></code></li><li class="L8"><code><span class="pln">        queue</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="pln">request</span><span class="pun">);</span></code></li><li class="L9"><code><span class="pln">    </span><span class="pun">}</span></code></li><li class="L0"><code></code></li><li class="L1"><code><span class="pln">    </span><span class="com">/**</span></code></li><li class="L2"><code><span class="com">     * 请求网络的图片资源，下载图片在本地和内存中,并显示在页面上，这里也是做了二级缓存机制</span></code></li><li class="L3"><code><span class="com">     *内存数据的存储需要用到一个类：LruCache</span></code></li><li class="L4"><code><span class="com">     */</span></code></li><li class="L5"><code><span class="pln">    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> net4</span><span class="pun">(</span><span class="typ">View</span><span class="pln"> view</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L6"><code><span class="pln">        </span><span class="com">//使用Volley的静态方法来获得队列对象</span></code></li><li class="L7"><code><span class="pln">        </span><span class="typ">RequestQueue</span><span class="pln"> queue </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Volley</span><span class="pun">.</span><span class="pln">newRequestQueue</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">);</span></code></li><li class="L8"><code></code></li><li class="L9"><code><span class="pln">        </span><span class="com">//创建下载图片对象，两个参数</span></code></li><li class="L0"><code><span class="pln">        </span><span class="com">//第一个参数：队列对象</span></code></li><li class="L1"><code><span class="pln">        </span><span class="com">//第二个参数：图片下载成功后的缓存接口对象</span></code></li><li class="L2"><code><span class="pln">        </span><span class="typ">ImageLoader</span><span class="pln"> loader </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ImageLoader</span><span class="pun">(</span><span class="pln">queue</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ImageLoader</span><span class="pun">.</span><span class="typ">ImageCache</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L3"><code><span class="pln">            </span><span class="lit">@Override</span></code></li><li class="L4"><code><span class="pln">            </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">Bitmap</span><span class="pln"> getBitmap</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> url</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L5"><code><span class="pln">                </span><span class="com">//通過内存类获取数据</span></code></li><li class="L6"><code><span class="pln">                </span><span class="kwd">return</span><span class="pln"> cache</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="pln">url</span><span class="pun">);</span></code></li><li class="L7"><code><span class="pln">            </span><span class="pun">}</span></code></li><li class="L8"><code></code></li><li class="L9"><code><span class="pln">            </span><span class="lit">@Override</span></code></li><li class="L0"><code><span class="pln">            </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> putBitmap</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> url</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Bitmap</span><span class="pln"> bitmap</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code><span class="pln">                </span><span class="com">//通過内存类保存数据</span></code></li><li class="L2"><code><span class="pln">                cache</span><span class="pun">.</span><span class="pln">put</span><span class="pun">(</span><span class="pln">url</span><span class="pun">,</span><span class="pln"> bitmap</span><span class="pun">);</span></code></li><li class="L3"><code><span class="pln">            </span><span class="pun">}</span></code></li><li class="L4"><code></code></li><li class="L5"><code><span class="pln">            </span><span class="com">//创建一个图片缓存数据的对象,需要的参数是图片可保存的数据大小</span></code></li><li class="L6"><code><span class="pln">            </span><span class="kwd">int</span><span class="pln"> data </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Runtime</span><span class="pun">.</span><span class="pln">getRuntime</span><span class="pun">().</span><span class="pln">maxMemory</span><span class="pun">()</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">8</span><span class="pun">);</span></code></li><li class="L7"><code><span class="pln">            </span><span class="typ">LruCache</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Bitmap</span><span class="pun">&gt;</span><span class="pln"> cache </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">LruCache</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Bitmap</span><span class="pun">&gt;(</span><span class="pln">data</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L8"><code><span class="pln">                </span><span class="lit">@Override</span></code></li><li class="L9"><code><span class="pln">                </span><span class="kwd">protected</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> sizeOf</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> key</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Bitmap</span><span class="pln"> value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L0"><code><span class="pln">                    </span><span class="com">//返回图片数据的大小</span></code></li><li class="L1"><code><span class="pln">                    </span><span class="kwd">return</span><span class="pln"> value</span><span class="pun">.</span><span class="pln">getByteCount</span><span class="pun">();</span></code></li><li class="L2"><code><span class="pln">                </span><span class="pun">}</span></code></li><li class="L3"><code><span class="pln">            </span><span class="pun">};</span></code></li><li class="L4"><code><span class="pln">        </span><span class="pun">});</span></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="pln">        </span><span class="com">//执行下载操作</span></code></li><li class="L7"><code><span class="pln">        </span><span class="com">//设置下载图片的对象， 两个参数</span></code></li><li class="L8"><code><span class="pln">        </span><span class="com">// 第一个参数:URL地址</span></code></li><li class="L9"><code><span class="pln">        </span><span class="com">//第二个参数，网络请求成功的回调对象</span></code></li><li class="L0"><code><span class="pln">        loader</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">"http://pic1.win4000.com/pic/2/5b/557796359.jpg"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ImageLoader</span><span class="pun">.</span><span class="typ">ImageListener</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code><span class="pln">            </span><span class="lit">@Override</span></code></li><li class="L2"><code><span class="pln">            </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> onResponse</span><span class="pun">(</span><span class="typ">ImageLoader</span><span class="pun">.</span><span class="typ">ImageContainer</span><span class="pln"> response</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">boolean</span><span class="pln"> isImmediate</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L3"><code><span class="pln">                </span><span class="com">//把下载到的Bitmap对象放到指定的图片对象中显示</span></code></li><li class="L4"><code><span class="pln">                imageView</span><span class="pun">.</span><span class="pln">setImageBitmap</span><span class="pun">(</span><span class="pln">response</span><span class="pun">.</span><span class="pln">getBitmap</span><span class="pun">());</span></code></li><li class="L5"><code><span class="pln">            </span><span class="pun">}</span></code></li><li class="L6"><code></code></li><li class="L7"><code><span class="pln">            </span><span class="lit">@Override</span></code></li><li class="L8"><code><span class="pln">            </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> onErrorResponse</span><span class="pun">(</span><span class="typ">VolleyError</span><span class="pln"> error</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="pln">            </span><span class="pun">}</span></code></li><li class="L1"><code><span class="pln">        </span><span class="pun">});</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="pln">    </span><span class="pun">}</span></code></li><li class="L4"><code></code></li><li class="L5"><code><span class="pln">    </span><span class="com">/**</span></code></li><li class="L6"><code><span class="com">     * 创建一个连接错误的监听对象</span></code></li><li class="L7"><code><span class="com">     * 因为上面每一个请求的对象都需要错误接口的监听对象，所以这里抽出来写</span></code></li><li class="L8"><code><span class="com">     */</span></code></li><li class="L9"><code><span class="pln">    </span><span class="kwd">private</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">.</span><span class="typ">ErrorListener</span><span class="pln"> error </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">.</span><span class="typ">ErrorListener</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L0"><code><span class="pln">        </span><span class="lit">@Override</span></code></li><li class="L1"><code><span class="pln">        </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> onErrorResponse</span><span class="pun">(</span><span class="typ">VolleyError</span><span class="pln"> error</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L2"><code><span class="pln">            </span><span class="com">//打印错误信息</span></code></li><li class="L3"><code><span class="pln">            </span><span class="typ">ShowUtils</span><span class="pun">.</span><span class="pln">e</span><span class="pun">(</span><span class="str">"错误信息："</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> error</span><span class="pun">.</span><span class="pln">getMessage</span><span class="pun">());</span></code></li><li class="L4"><code><span class="pln">        </span><span class="pun">}</span></code></li><li class="L5"><code><span class="pln">    </span><span class="pun">};</span></code></li><li class="L6"><code></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="pun">}</span></code></li></ol></pre><p data-anchor-id="fvj7">（四）上面使用了一个显示Log的工具类</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="6oms"><ol class="linenums"><li class="L0"><code><span class="kwd">package</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">lwz</span><span class="pun">.</span><span class="pln">volley</span><span class="pun">;</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="kwd">import</span><span class="pln"> android</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.</span><span class="typ">Log</span><span class="pun">;</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="com">/**</span></code></li><li class="L5"><code><span class="com"> * 本类用于简易的Log显示信息</span></code></li><li class="L6"><code><span class="com"> * </span></code></li><li class="L7"><code><span class="com"> */</span></code></li><li class="L8"><code></code></li><li class="L9"><code><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">ShowUtils</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L0"><code><span class="pln">    </span><span class="com">//这里DEBUG的作用是，可以在程序完成后设置DEBUG的值为false，程序以后就不会再显示以前的打印信息</span></code></li><li class="L1"><code><span class="pln">    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">boolean</span><span class="pln"> DEBUG </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="pln">    </span><span class="com">//各种Log打印</span></code></li><li class="L4"><code><span class="pln">    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> e</span><span class="pun">(</span><span class="typ">Object</span><span class="pln"> o</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L5"><code><span class="pln">        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">DEBUG</span><span class="pun">)</span></code></li><li class="L6"><code><span class="pln">            </span><span class="typ">Log</span><span class="pun">.</span><span class="pln">e</span><span class="pun">(</span><span class="str">"TAG"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"打印：------      "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> o</span><span class="pun">.</span><span class="pln">toString</span><span class="pun">());</span></code></li><li class="L7"><code><span class="pln">    </span><span class="pun">}</span></code></li><li class="L8"><code></code></li><li class="L9"><code><span class="pln">    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> e</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L0"><code><span class="pln">        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">DEBUG</span><span class="pun">)</span></code></li><li class="L1"><code><span class="pln">            </span><span class="typ">Log</span><span class="pun">.</span><span class="pln">e</span><span class="pun">(</span><span class="str">"TAG"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"打印：------      "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> i</span><span class="pun">);</span></code></li><li class="L2"><code><span class="pln">    </span><span class="pun">}</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="pln">    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> e</span><span class="pun">(</span><span class="kwd">float</span><span class="pln"> i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L5"><code><span class="pln">        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">DEBUG</span><span class="pun">)</span></code></li><li class="L6"><code><span class="pln">            </span><span class="typ">Log</span><span class="pun">.</span><span class="pln">e</span><span class="pun">(</span><span class="str">"TAG"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"打印：------      "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> i</span><span class="pun">);</span></code></li><li class="L7"><code><span class="pln">    </span><span class="pun">}</span></code></li><li class="L8"><code></code></li><li class="L9"><code><span class="pln">    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> e</span><span class="pun">(</span><span class="kwd">boolean</span><span class="pln"> b</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L0"><code><span class="pln">        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">DEBUG</span><span class="pun">)</span></code></li><li class="L1"><code><span class="pln">            </span><span class="typ">Log</span><span class="pun">.</span><span class="pln">e</span><span class="pun">(</span><span class="str">"TAG"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"打印：------      "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> b</span><span class="pun">);</span></code></li><li class="L2"><code><span class="pln">    </span><span class="pun">}</span></code></li><li class="L3"><code><span class="pun">}</span></code></li></ol></pre><p data-anchor-id="y4mx">上面程序在断网中也能请求并显示图片，但是不能再请求字符串。第四种请求方式比第三种请求方式更高效。。</p><pre data-anchor-id="q30e"><code>   使用Volley的设计目标就是非常适合去进行数据量不大，但通信频繁的网络操作, 例如像微博这样的APP或类似新闻客户端的APP.
</code></pre></div>
</body>
</html>