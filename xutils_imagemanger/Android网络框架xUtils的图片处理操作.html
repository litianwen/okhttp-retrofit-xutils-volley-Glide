<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Android网络框架xUtils的图片处理操作</title>
</head>
<body>
<div id="wmd-preview" class="wmd-preview"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="3qa3" id="android网络框架xutils的图片处理操作">Android网络框架xUtils的图片处理操作</h1><hr><ul data-anchor-id="jlxo">
<li><strong>使用示例</strong></li>
</ul><p data-anchor-id="1xtq">（一）添加依赖语句</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="tb1o"><ol class="linenums"><li class="L0"><code><span class="pln">compile </span><span class="str">'org.xutils:xutils:3.3.38'</span></code></li></ol></pre><p data-anchor-id="dp7t">（二）添加权限</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="28k0"><ol class="linenums"><li class="L0"><code><span class="tag">&lt;uses-permission</span><span class="pln"> </span><span class="atn">android:name</span><span class="pun">=</span><span class="atv">"android.permission.INTERNET"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></li><li class="L1"><code><span class="tag">&lt;uses-permission</span><span class="pln"> </span><span class="atn">android:name</span><span class="pun">=</span><span class="atv">"android.permission.WRITE_EXTERNAL_STORAGE"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></li></ol></pre><p data-anchor-id="gsf0">（三）在自己的Application中的onCreate方法里注册xutils</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="9nq2"><ol class="linenums"><li class="L0"><code><span class="pln">x</span><span class="pun">.</span><span class="typ">Ext</span><span class="pun">.</span><span class="pln">init</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">);</span></code></li></ol></pre><p data-anchor-id="i2l3">这里要记得在AndroidManifest中添加Application中的name。</p><p data-anchor-id="7ef7">（四）设计布局activity_main.xml文件</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="grmv"><ol class="linenums"><li class="L0"><code><span class="pun">&lt;?</span><span class="pln">xml version</span><span class="pun">=</span><span class="str">"1.0"</span><span class="pln"> encoding</span><span class="pun">=</span><span class="str">"utf-8"</span><span class="pun">?&gt;</span></code></li><li class="L1"><code><span class="tag">&lt;LinearLayout</span><span class="pln"> </span><span class="atn">xmlns:android</span><span class="pun">=</span><span class="atv">"http://schemas.android.com/apk/res/android"</span></code></li><li class="L2"><code><span class="pln">    </span><span class="atn">android:layout_width</span><span class="pun">=</span><span class="atv">"match_parent"</span></code></li><li class="L3"><code><span class="pln">    </span><span class="atn">android:layout_height</span><span class="pun">=</span><span class="atv">"match_parent"</span></code></li><li class="L4"><code><span class="pln">    </span><span class="atn">android:orientation</span><span class="pun">=</span><span class="atv">"vertical"</span><span class="tag">&gt;</span></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="pln">    </span><span class="tag">&lt;TextView</span></code></li><li class="L7"><code><span class="pln">        </span><span class="atn">android:layout_width</span><span class="pun">=</span><span class="atv">"wrap_content"</span></code></li><li class="L8"><code><span class="pln">        </span><span class="atn">android:layout_height</span><span class="pun">=</span><span class="atv">"wrap_content"</span></code></li><li class="L9"><code><span class="pln">        </span><span class="atn">android:text</span><span class="pun">=</span><span class="atv">"网络图片"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></li><li class="L0"><code></code></li><li class="L1"><code><span class="pln">    </span><span class="tag">&lt;ImageView</span></code></li><li class="L2"><code><span class="pln">        </span><span class="atn">android:id</span><span class="pun">=</span><span class="atv">"@+id/iv1"</span></code></li><li class="L3"><code><span class="pln">        </span><span class="atn">android:layout_width</span><span class="pun">=</span><span class="atv">"300dp"</span></code></li><li class="L4"><code><span class="pln">        </span><span class="atn">android:layout_height</span><span class="pun">=</span><span class="atv">"300dp"</span></code></li><li class="L5"><code><span class="pln">        </span><span class="atn">android:layout_margin</span><span class="pun">=</span><span class="atv">"10dp"</span></code></li><li class="L6"><code><span class="pln">        </span><span class="atn">android:scaleType</span><span class="pun">=</span><span class="atv">"fitXY"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="pln">    </span><span class="tag">&lt;TextView</span></code></li><li class="L9"><code><span class="pln">        </span><span class="atn">android:layout_width</span><span class="pun">=</span><span class="atv">"wrap_content"</span></code></li><li class="L0"><code><span class="pln">        </span><span class="atn">android:layout_height</span><span class="pun">=</span><span class="atv">"wrap_content"</span></code></li><li class="L1"><code><span class="pln">        </span><span class="atn">android:text</span><span class="pun">=</span><span class="atv">"本地图片"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="pln">    </span><span class="tag">&lt;ImageView</span></code></li><li class="L4"><code><span class="pln">        </span><span class="atn">android:id</span><span class="pun">=</span><span class="atv">"@+id/iv2"</span></code></li><li class="L5"><code><span class="pln">        </span><span class="atn">android:layout_width</span><span class="pun">=</span><span class="atv">"300dp"</span></code></li><li class="L6"><code><span class="pln">        </span><span class="atn">android:layout_height</span><span class="pun">=</span><span class="atv">"300dp"</span></code></li><li class="L7"><code><span class="pln">        </span><span class="atn">android:layout_margin</span><span class="pun">=</span><span class="atv">"10dp"</span></code></li><li class="L8"><code><span class="pln">        </span><span class="atn">android:scaleType</span><span class="pun">=</span><span class="atv">"fitXY"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></li><li class="L9"><code><span class="tag">&lt;/LinearLayout&gt;</span></code></li></ol></pre><p data-anchor-id="4wpj">（五）设计java代码</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="bggc"><ol class="linenums"><li class="L0"><code><span class="kwd">package</span><span class="pln"> fuxi</span><span class="pun">.</span><span class="pln">xutils</span><span class="pun">;</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="kwd">import</span><span class="pln"> android</span><span class="pun">.</span><span class="pln">os</span><span class="pun">.</span><span class="typ">Bundle</span><span class="pun">;</span></code></li><li class="L3"><code><span class="kwd">import</span><span class="pln"> android</span><span class="pun">.</span><span class="pln">support</span><span class="pun">.</span><span class="pln">v7</span><span class="pun">.</span><span class="pln">app</span><span class="pun">.</span><span class="typ">AppCompatActivity</span><span class="pun">;</span></code></li><li class="L4"><code><span class="kwd">import</span><span class="pln"> android</span><span class="pun">.</span><span class="pln">widget</span><span class="pun">.</span><span class="typ">ImageView</span><span class="pun">;</span></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="kwd">import</span><span class="pln"> org</span><span class="pun">.</span><span class="pln">xutils</span><span class="pun">.</span><span class="pln">x</span><span class="pun">;</span></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">File</span><span class="pun">;</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MainActivity</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">AppCompatActivity</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pln">    </span><span class="lit">@Override</span></code></li><li class="L3"><code><span class="pln">    </span><span class="kwd">protected</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> onCreate</span><span class="pun">(</span><span class="typ">Bundle</span><span class="pln"> savedInstanceState</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L4"><code><span class="pln">        </span><span class="kwd">super</span><span class="pun">.</span><span class="pln">onCreate</span><span class="pun">(</span><span class="pln">savedInstanceState</span><span class="pun">);</span></code></li><li class="L5"><code><span class="pln">        setContentView</span><span class="pun">(</span><span class="pln">R</span><span class="pun">.</span><span class="pln">layout</span><span class="pun">.</span><span class="pln">activity_main</span><span class="pun">);</span></code></li><li class="L6"><code><span class="pln">        </span><span class="typ">ImageView</span><span class="pln"> imageView </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">ImageView</span><span class="pun">)</span><span class="pln"> findViewById</span><span class="pun">(</span><span class="pln">R</span><span class="pun">.</span><span class="pln">id</span><span class="pun">.</span><span class="pln">iv1</span><span class="pun">);</span></code></li><li class="L7"><code><span class="pln">        </span><span class="typ">ImageView</span><span class="pln"> imageView2 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">ImageView</span><span class="pun">)</span><span class="pln"> findViewById</span><span class="pun">(</span><span class="pln">R</span><span class="pun">.</span><span class="pln">id</span><span class="pun">.</span><span class="pln">iv2</span><span class="pun">);</span></code></li><li class="L8"><code></code></li><li class="L9"><code><span class="pln">        </span><span class="com">//xUtils绑定网络图片</span></code></li><li class="L0"><code><span class="pln">        </span><span class="com">//第一个参数是ImageView对象</span></code></li><li class="L1"><code><span class="pln">        </span><span class="com">//第二个参数是URL字符串地址</span></code></li><li class="L2"><code><span class="pln">        x</span><span class="pun">.</span><span class="pln">image</span><span class="pun">().</span><span class="pln">bind</span><span class="pun">(</span><span class="pln">imageView</span><span class="pun">,</span><span class="pln"> </span><span class="str">"http://p0.so.qhmsg.com/sdr/600_900_/t01d43698fbeca29695.jpg"</span><span class="pun">);</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="pln">        </span><span class="com">//xUtils绑定本地图片</span></code></li><li class="L5"><code><span class="pln">        </span><span class="com">//第一个参数是ImageView对象</span></code></li><li class="L6"><code><span class="pln">        </span><span class="com">//第二个参数是URL字符串地址,这里非要转换为File后在获取地址，直接使用"mnt/sdcard/a1.jpg"不行！</span></code></li><li class="L7"><code><span class="pln">        x</span><span class="pun">.</span><span class="pln">image</span><span class="pun">().</span><span class="pln">bind</span><span class="pun">(</span><span class="pln">imageView2</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">File</span><span class="pun">(</span><span class="str">"mnt/sdcard/a1.jpg"</span><span class="pun">).</span><span class="pln">getAbsolutePath</span><span class="pun">());</span></code></li><li class="L8"><code><span class="pln">        </span><span class="com">//一般的如果是绑定本地图片，是不会使用框架的，下面这个语句就可以了</span></code></li><li class="L9"><code><span class="pln">        </span><span class="com">// imageView2.setImageURI(Uri.fromFile(new File("mnt/sdcard/a1.jpg")));</span></code></li><li class="L0"><code><span class="pln">    </span><span class="pun">}</span></code></li><li class="L1"><code><span class="pun">}</span></code></li></ol></pre><ul data-anchor-id="4j0o">
<li><strong>复杂一点的使用示例</strong> <br>
设置图片的各种属性的设置，这里只做Java代码的设计，前需要的步骤和上面程序是一样的。布局文件也是用上面的，把两个TextView去掉就可以。</li>
</ul><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="nsu9"><ol class="linenums"><li class="L0"><code><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">LoadImageView</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">AppCompatActivity</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code><span class="pln">    </span><span class="lit">@Override</span></code></li><li class="L2"><code><span class="pln">    </span><span class="kwd">protected</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> onCreate</span><span class="pun">(</span><span class="lit">@Nullable</span><span class="pln"> </span><span class="typ">Bundle</span><span class="pln"> savedInstanceState</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L3"><code><span class="pln">        </span><span class="kwd">super</span><span class="pun">.</span><span class="pln">onCreate</span><span class="pun">(</span><span class="pln">savedInstanceState</span><span class="pun">);</span></code></li><li class="L4"><code><span class="pln">        setContentView</span><span class="pun">(</span><span class="pln">R</span><span class="pun">.</span><span class="pln">layout</span><span class="pun">.</span><span class="pln">activity_main</span><span class="pun">);</span></code></li><li class="L5"><code><span class="pln">        </span><span class="typ">ImageView</span><span class="pln"> imageView </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">ImageView</span><span class="pun">)</span><span class="pln"> findViewById</span><span class="pun">(</span><span class="pln">R</span><span class="pun">.</span><span class="pln">id</span><span class="pun">.</span><span class="pln">iv1</span><span class="pun">);</span></code></li><li class="L6"><code><span class="pln">        </span><span class="typ">ImageView</span><span class="pln"> imageView2 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">ImageView</span><span class="pun">)</span><span class="pln"> findViewById</span><span class="pun">(</span><span class="pln">R</span><span class="pun">.</span><span class="pln">id</span><span class="pun">.</span><span class="pln">iv2</span><span class="pun">);</span></code></li><li class="L7"><code><span class="pln">        </span><span class="com">//设置图片属性的options</span></code></li><li class="L8"><code><span class="pln">        </span><span class="typ">ImageOptions</span><span class="pln"> options </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ImageOptions</span><span class="pun">.</span><span class="typ">Builder</span><span class="pun">()</span></code></li><li class="L9"><code><span class="pln">                </span><span class="com">//设置图片的大小</span></code></li><li class="L0"><code><span class="pln">                </span><span class="pun">.</span><span class="pln">setSize</span><span class="pun">(</span><span class="lit">300</span><span class="pun">,</span><span class="pln"> </span><span class="lit">300</span><span class="pun">)</span></code></li><li class="L1"><code><span class="pln">                </span><span class="com">// 如果ImageView的大小不是定义为wrap_content, 不要crop.</span></code></li><li class="L2"><code><span class="pln">                </span><span class="pun">.</span><span class="pln">setCrop</span><span class="pun">(</span><span class="kwd">true</span><span class="pun">)</span></code></li><li class="L3"><code><span class="pln">                </span><span class="com">// 加载中或错误图片的ScaleType</span></code></li><li class="L4"><code><span class="pln">                </span><span class="com">//.setPlaceholderScaleType(ImageView.ScaleType.MATRIX)</span></code></li><li class="L5"><code><span class="pln">                </span><span class="pun">.</span><span class="pln">setImageScaleType</span><span class="pun">(</span><span class="typ">ImageView</span><span class="pun">.</span><span class="typ">ScaleType</span><span class="pun">.</span><span class="pln">CENTER_CROP</span><span class="pun">)</span></code></li><li class="L6"><code><span class="pln">                </span><span class="com">//设置加载过程中的图片</span></code></li><li class="L7"><code><span class="pln">                </span><span class="pun">.</span><span class="pln">setLoadingDrawableId</span><span class="pun">(</span><span class="pln">R</span><span class="pun">.</span><span class="pln">mipmap</span><span class="pun">.</span><span class="pln">ic_launcher</span><span class="pun">)</span></code></li><li class="L8"><code><span class="pln">                </span><span class="com">//设置加载失败后的图片</span></code></li><li class="L9"><code><span class="pln">                </span><span class="pun">.</span><span class="pln">setFailureDrawableId</span><span class="pun">(</span><span class="pln">R</span><span class="pun">.</span><span class="pln">mipmap</span><span class="pun">.</span><span class="pln">ic_launcher</span><span class="pun">)</span></code></li><li class="L0"><code><span class="pln">                </span><span class="com">//设置使用缓存</span></code></li><li class="L1"><code><span class="pln">                </span><span class="pun">.</span><span class="pln">setUseMemCache</span><span class="pun">(</span><span class="kwd">true</span><span class="pun">)</span></code></li><li class="L2"><code><span class="pln">                </span><span class="com">//设置支持gif</span></code></li><li class="L3"><code><span class="pln">                </span><span class="pun">.</span><span class="pln">setIgnoreGif</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">)</span></code></li><li class="L4"><code><span class="pln">                </span><span class="com">//设置显示圆形图片</span></code></li><li class="L5"><code><span class="pln">                </span><span class="pun">.</span><span class="pln">setCircular</span><span class="pun">(</span><span class="kwd">true</span><span class="pun">).</span><span class="pln">build</span><span class="pun">();</span></code></li><li class="L6"><code><span class="pln">        x</span><span class="pun">.</span><span class="pln">image</span><span class="pun">().</span><span class="pln">bind</span><span class="pun">(</span><span class="pln">imageView</span><span class="pun">,</span><span class="pln"> </span><span class="str">"http://p4.so.qhmsg.com/sdr/600_900_/t01f4e6c53f0e23d459.jpg"</span><span class="pun">,</span><span class="pln"> options</span><span class="pun">);</span></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="pln">        </span><span class="com">//设置第二张图片属性的options</span></code></li><li class="L9"><code><span class="pln">        </span><span class="typ">ImageOptions</span><span class="pln"> options2 </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ImageOptions</span><span class="pun">.</span><span class="typ">Builder</span><span class="pun">()</span></code></li><li class="L0"><code><span class="pln">                </span><span class="com">//设置图片的大小</span></code></li><li class="L1"><code><span class="pln">                </span><span class="pun">.</span><span class="pln">setSize</span><span class="pun">(</span><span class="typ">DensityUtil</span><span class="pun">.</span><span class="pln">dip2px</span><span class="pun">(</span><span class="lit">120</span><span class="pun">),</span><span class="pln"> </span><span class="typ">DensityUtil</span><span class="pun">.</span><span class="pln">dip2px</span><span class="pun">(</span><span class="lit">120</span><span class="pun">))</span></code></li><li class="L2"><code><span class="pln">                </span><span class="com">//设置边角的圆形</span></code></li><li class="L3"><code><span class="pln">                </span><span class="pun">.</span><span class="pln">setRadius</span><span class="pun">(</span><span class="typ">DensityUtil</span><span class="pun">.</span><span class="pln">dip2px</span><span class="pun">(</span><span class="lit">5</span><span class="pun">))</span></code></li><li class="L4"><code><span class="pln">                </span><span class="com">//创建</span></code></li><li class="L5"><code><span class="pln">                </span><span class="pun">.</span><span class="pln">build</span><span class="pun">();</span></code></li><li class="L6"><code><span class="pln">        x</span><span class="pun">.</span><span class="pln">image</span><span class="pun">().</span><span class="pln">bind</span><span class="pun">(</span><span class="pln">imageView2</span><span class="pun">,</span><span class="pln"> </span><span class="str">"http://p2.so.qhmsg.com/sdr/599_900_/t019e91b7618003e862.jpg"</span><span class="pun">,</span><span class="pln"> options2</span><span class="pun">);</span></code></li><li class="L7"><code><span class="pln">    </span><span class="pun">}</span></code></li><li class="L8"><code><span class="pun">}</span></code></li></ol></pre><pre data-anchor-id="wt5m"><code>    上面一样是显示两个图片，一个圆形的图片，一个简单设置显示的图片。                                                                     
    上面就是xutils绑定图片的使用的两种简单方式，第一种直接加载图片不能进行图片处理，第二种方式可以对图片进行各种处理。 
</code></pre></div>
</body>
</html>